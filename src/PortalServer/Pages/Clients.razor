@page "/clients"
@inject HttpClient Http
@using Newtonsoft.Json

<h3>Clients</h3>

@LoginMessage

@if(clients.Count() >= 0)
            {
                foreach (var client in clients)
                {
                    <p>@client.Folder_name</p>
                }
            }


@code {
    public List<ClientModel> clients = new();
    public string json_client = null;
    public string LoginMessage { get; set; }


    protected async override Task OnInitializedAsync()
    {

        #region "API Request and Response" 
        // Preparing the httpRequestMessage to handle my request
        HttpRequestMessage httpRequestMessage = new();
        httpRequestMessage.Method = new HttpMethod("GET");
        httpRequestMessage.RequestUri = new Uri(@"https://localhost:44315/api/Folders/");


        var response = await Http.SendAsync(httpRequestMessage);

        var responseStatusCode = response.StatusCode;
        var responseBody = await response.Content.ReadAsStringAsync();

        #endregion

        if (responseStatusCode.ToString() == "OK") // If the user credentials are legit it will be true
        {
            LoginMessage = "Yes List";
            clients = JsonConvert.DeserializeObject<List<ClientModel>>(responseBody);
        }
        else
        {
            LoginMessage = "No List";
        }


    }
}
